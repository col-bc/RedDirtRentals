{% extends "base.html" %}
<!---->
{% block title %}Admin | Inventory{% endblock %}
<!---->
{% block content %}
<div class="container-fluid bg-dark text-light p-4">
    <h3 class="">Administration Dashboard</h3>
</div>

{{rental}}

<div class="container">
    {% with messages = get_flashed_messages() %} {% if messages %} {% for message in messages %}
    <div class="alert alert-light">
        <p>{{ message }}</p>
    </div>
    {% endfor %} {% endif %} {% endwith %}
</div>

<!--Tab Selector-->
<div class="container-fluid p-3 border-bottom shadow-sm">
    <ul class="nav nav-pills nav-fill"
        id="tab_root">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle active"
               data-bs-toggle="dropdown"
               id="inventory_active_elem"
               role="button"
               aria-expanded="false">
                <i class="fas fa-tractor me-3"></i>
                Inventory
            </a>
            <ul class="dropdown-menu shadow-sm w-100">
                <li>
                    <a class="dropdown-item"
                       id="inventory_tab_selector"
                       href="#">Manage</a>
                </li>
                <li>
                    <a class="dropdown-item"
                       href="{{ url_for('admin.new') }}">Add</a>
                </li>
            </ul>
        </li>
        <li class="nav-item">
            <a class="nav-link"
               href="#"
               id="reservations_tab_selector">
                <i class="fas fa-calendar-check me-3"></i>
                Reservations
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link"
               id="customer_tab_selector"
               href="#">
                <i class="fas fa-users me-4"></i>
                Customers
            </a>
        </li>
    </ul>
</div>

<div class="container p-3 mb-3"
     id="inventory_tab_content">

    <!--Search Form-->
    <div class="container mt-3 mb-5">
        <form action=""
              method="">
            <input class="form-control"
                   type="text"
                   name="inventory_query "
                   placeholder="Search Inventory">
        </form>
    </div>

    {% for rental in rentals %}

    <div class="card my-3"
         id="inventory-panel-{{ rental.rental_id }}">

        <!--Panel Header-->
        <div class="card-header d-flex flex-row p-3">
            <div class="container">
                <h5 class="card-title">
                    {{ rental.make }} {{ rental.model }}
                </h5>
                <p class="card-subtitle ff-primary text-muted">{{rental.category}}-{{rental.stock}}</p>
            </div>

            <a class="btn btn-outline-dark d-flex flex-column align-items-center p-2 mx-1 "
               href="{{ url_for( 'admin.details', id=rental.rental_id) }} ">
                <i class="fas fa-cog"></i>Manage
            </a>
            <a class="btn btn-outline-dark d-flex flex-column align-items-center p-2 mx-1"
               data-bs-toggle="collapse"
               href="#collapse_rental_{{rental.rental_id}}"
               aria-expanded="false"
               aria-controls="collapse_rental_{{rental.rental_id}}">
                <i class="fas fa-chevron-down"></i>
                Expand
            </a>
        </div>

        <div class="collapse card-body"
             id="collapse_rental_{{rental.rental_id}}">
            <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>ID:</strong>&nbsp;{{ rental.rental_id }}</li>
                <li class="list-group-item"><strong>Category: &nbsp;</strong> {{ rental.category }}</li>
                <li class="list-group-item"><strong>Stock: &nbsp;</strong> {{ rental.stock }}</li>
                <li class="list-group-item"><strong>Fuel Type: &nbsp;</strong> {{ rental.fuel_type }}</li>
                <li class="list-group-item"><strong>Horsepower: &nbsp;</strong> {{ rental.horse_power }}</li>
                <li class="list-group-item"><strong>Implements: &nbsp;</strong> {{ rental.implements }} </li>
                <li class="list-group-item"><strong>Deck Size: &nbsp;</strong> {{ rental.deck_size }}</li>
                <li class="list-group-item"><strong>Drive Type: &nbsp;</strong> {{ rental.drive }}</li>
                <li class="list-group-item"><strong>Rate: &nbsp;</strong> ${{ '%0.2f'%rental.rate[0] }}</li>
                <li class="list-group-item"><strong>Images: &nbsp;</strong>
                    {% if rental.image_paths != 'None' %}
                    {% for path in rental.image_paths %}
                    <a href="{{url_for('static', filename='uploads/'+path)}}"
                       target="_blank">{{path}}</a>
                    {% endfor %}
                    {% else %}
                    <span>None</span>
                    {% endif %}
                </li>
                <li class="list-group-item"><strong>Job Category: &nbsp;</strong> {{ rental.job_category }}</li>
                <li class="list-group-item"><strong>Price Range: &nbsp;</strong> {{ rental.price_range }}</li>
                <li class="list-group-item"><strong>Available for Rent: &nbsp;</strong>
                    {% if rental.is_available == 1 %}
                    Yes <i class="fas fa-check ml-3"></i>
                    {% else %}
                    No <i class="fas fa-times ml-3"></i>
                    {% endif %}
                </li>
                <li class="list-group-item"><strong>Available On: &nbsp;</strong> {{ rental.available_on }}</li>
                <li class="list-group-item"><strong>Rented By: &nbsp;</strong> {{ rental.rented_by }}</li>
                <li class="list-group-item"><strong>Rent Queue: &nbsp;</strong> {{ rental.rent_queue }}</li>
                <li class="list-group-item"><strong>Customer Viewable: &nbsp;</strong>
                    {% if rental.is_shown == 1 %}
                    Yes <i class="fas fa-check ml-3"></i>
                    {% else %}
                    No <i class="fas fa-times ml-3"></i>
                    {% endif %}
                </li>
            </ul>
            <a href="{{ url_for( 'admin.details', id=rental.rental_id) }}"
               class="card-link">Manage</a>
        </div>
    </div>

    {% endfor %}
</div>

<div id="reservation_tab_content"
     class="container">

    {% for reservation in reservations %}

    {%set cust_id = reservation[2]%}
    {% for customer in customers %}
    {% if cust_id == customer[0] %}
    {% set cust = customer %}
    <div class="card my-3 p-3">
        <h4 class="card-title">{{cust[1]}} {{cust[2]}}</h4>
        <div class="card-body">
            <p>{{cust[0]}}</p>
            <p>{{cust[3]}}</p>
            <p>{{cust[4]}}</p>
            <p>{{cust[5]}}</p>
            <p>{{cust[6]}}</p>
            <p>{{cust[7]}}</p>
        </div>
    </div>
    {%endif%}
    {% endfor %}


    {%endfor%}
</div>

<div class="container p-3 mb-3"
     id="customer_tab_content">
    <h3>Customers</h3>
</div>
{% endblock %}
