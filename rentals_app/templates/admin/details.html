{% extends "base.html" %}
<!---->
{% block title %}Update | Admin{% endblock %}
<!---->
{% block content %}
<div class="container is-fluid my-5">
    <div class="container is-max-desktop">

        <h1 class="title is-family-title is-family-secondary has-background-light p-5"
            style="border-bottom: 2px solid whitesmoke;">
            New Rental
            <a href="{{ url_for('admin.inventory') }}"
               class="button is-info is-outlined is-pulled-right">
                <i class="fas fa-arrow-left mr-3"></i> Back
            </a>
        </h1>

        <!--Flashes-->
        <div class="container">
            {% with messages = get_flashed_messages() %} {% if messages %} {% for message in messages %}
            <div class="notification is-light m3 has-text-centered">
                <button class="delete"></button>
                <p>{{ message }}</p>
            </div>
            {% endfor %} {% endif %} {% endwith %}
        </div>

        <form method="POST"
              action="{{ url_for('admin.update', id=rental.rental_id) }}"
              enctype="multipart/form-data"
              class="p-5 has-implement-adder">

            <!--Make/Model-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Make</label>
                    <div class="field">
                        <div class="field">
                            <input class="input "
                                   type="text"
                                   name="make"
                                   value="{{rental.make}}"
                                   placeholder="Make">
                        </div>
                    </div>
                </div>
                <div class="column">
                    <label class="label">Model</label>
                    <div class="field">
                        <div class="field">
                            <input class="input "
                                   type="text"
                                   name="model"
                                   value="{{rental.model}}"
                                   placeholder="Model">
                        </div>
                    </div>
                </div>
            </div>


            <!--Category/Fuel Type-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Fuel Type</label>
                    <div class="field">
                        <div class="select is-fullwidth">
                            <select name="fuel_type">
                                <option {%if
                                        rental.fuel_type=='Gasoline'
                                        %}selected{%endif%}>Gasoline</option>
                                <option {%if
                                        rental.fuel_type=='Diesel'
                                        %}selected{%endif%}>Diesel</option>
                                <option {%if
                                        rental.fuel_type=='Hybrid'
                                        %}selected{%endif%}>Hybrid</option>
                                <option {%if
                                        rental.fuel_type=='Other'
                                        %}selected{%endif%}>Other</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <label class="label">Category</label>
                    <div class="field">
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select name="category">
                                    <option {%if
                                            rental.category=='Tractor'
                                            %}selected{%endif%}>Tractor</option>
                                    <option {%if
                                            rental.category=='Mower'
                                            %}selected{%endif%}>Mower</option>
                                    <option {%if
                                            rental.category=='Power Tool'
                                            %}selected{%endif%}>Power Tool</option>
                                    <option {%if
                                            rental.category=='Add on'
                                            %}selected{%endif%}>Add on</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--Job Category/Drive Type-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Job Category</label>
                    <div class="field">
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select name="job_category">
                                    <option {%if
                                            rental.job_category=='Small Jobs'
                                            %}selected{%endif%}>Small Jobs</option>
                                    <option {%if
                                            rental.job_category=='Medium Jobs'
                                            %}selected{%endif%}>Medium Jobs</option>
                                    <option {%if
                                            rental.job_category=='Large Jobs'
                                            %}selected{%endif%}>Large Jobs</option>
                                    <option {%if
                                            rental.job_category=='Heavy Duty Jobs'
                                            %}selected{%endif%}>Heavy Duty Jobs</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <label class="label">Drive Type</label>
                    <div class="field">
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select name="drive">
                                    <option {%if
                                            rental.drive=='4WD'
                                            %}selected{%endif%}>4WD</option>
                                    <option {%if
                                            rental.drive=='2WD'
                                            %}selected{%endif%}>2WD</option>
                                    <option {%if
                                            rental.drive=='Other'
                                            %}selected{%endif%}>Other</option>
                                    <option {%if
                                            rental.drive=='NA'
                                            %}selected{%endif%}>NA</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--Horsepower/Deck Size-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label py-0">Horsepower</label>
                    <div class="field">
                        <input class="input "
                               type="number"
                               step="0.1"
                               value="{{rental.horse_power}}"
                               name="horse_power"
                               placeholder="Horsepower">
                    </div>
                </div>
                <div class="column">
                    <label class="label">Deck Size</label>
                    <div class="field">
                        <input class="input "
                               type="text"
                               value="{{rental.deck_size}}"
                               name="deck_size"
                               placeholder="Deck Size">
                    </div>
                </div>
            </div>

            <!--Stock-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Stock</label>
                    <div class="field">
                        <input class="input"
                               type="text"
                               name="stock"
                               value="{{rental.stock}}"
                               placeholder="Stock">
                    </div>
                </div>
            </div>

            <!--Pricing-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Hourly Rate</label>
                    <div class="field">
                        <input class="input"
                               type="number"
                               step="0.01"
                               name="rate"
                               value="{{'%0.2f'%rental.rate[0]}}"
                               placeholder="Hourly Rate">
                    </div>
                </div>
                <div class="column">
                    <label class="label">Price Category</label>
                    <div class="field">
                        <div class="control is-expanded">
                            <div class="select is-fullwidth">
                                <select name="price_range">
                                    <option {%if
                                            rental.price_range=='Cheap'
                                            %}selected{%endif%}>Cheap</option>
                                    <option {%if
                                            rental.price_range=='Affordable'
                                            %}selected{%endif%}>Affordable</option>
                                    <option {%if
                                            rental.price_range=='Normal'
                                            %}selected{%endif%}>Normal</option>
                                    <option {%if
                                            rental.price_range=='Costly'
                                            %}selected{%endif%}>Costly</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--Currently Rented/Available Date/Currently Available-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Currently Rented By</label>
                    <div class="field">
                        <input type="text"
                               class="input"
                               name="rented_by"
                               value="{{rental.rented_by}}"
                               placeholder="John Doe">
                        <div class="wrapper is-size-7">
                            <i class="fas fa-eye-slash mr-3"></i>This field <strong>will not </strong>be seen by customers.</p>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <label class="label">Date Available</label>
                    <div class="field">
                        <input type="date"
                               class="input"
                               value="{{rental.available_on}}"
                               name="available_on">
                        <div class="wrapper is-size-7">
                            <i class="fas fa-eye-slash mr-3">
                            </i>This field <strong>will not </strong>be seen by customers.</p>
                        </div>
                    </div>
                </div>
                <div class="column">
                    <label class="label">Currently Available</label>
                    <div class="field">
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select name="is_available"
                                        required>
                                    <option {%if
                                            rental.is_available=='Yes'
                                            %}selected{%endif%}>Yes</option>
                                    <option {%if
                                            rental.is_available=='No'
                                            %}selected{%endif%}>No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--Rent Queue-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Rental Queue</label>
                    <div class="field">
                        <textarea class="textarea"
                                  name="rent_queue"
                                  rows=3
                                  placeholder="Johnny Appleseed, Jane Doe, etc.">
                            {%- if rental.rent_queue -%}
                                {{rental.rent_queue}}
                            {%- endif -%}
                        </textarea>
                        <p class="help">
                            <i class="fas fa-info-circle mr-3"></i>Enter names separated by a comma.
                        </p>
                        <p class="help">
                            <i class="fas fa-eye-slash mr-3"></i>This field <strong>will not </strong>be seen by customers.
                        </p>
                    </div>
                </div>
            </div>

            <!--Is Hidden/Img Picker-->
            <div class="columns my-0 ">
                <div class="column">
                    <label class="label">Shown to Customers?</label>
                    <div class="field">
                        <div class="control ">
                            <div class="select is-fullwidth">
                                <select name="is_shown">
                                    <option {%if
                                            rental.is_shown=='Yes'
                                            %}selected{%endif%}>Yes</option>
                                    <option {%if
                                            rental.is_shown=='No'
                                            %}selected{%endif%}>No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column is-two-fifths">
                    <label class="label">Rental Image</label>
                    <div class="field">
                        <div class="file">
                            <label class="file-label">
                                <input class="button is-outlined"
                                       type="file"
                                       name="files">
                            </label>
                        </div>
                        <div class="container">
                            {% for path in rental.image_paths %}
                            <a href="{{url_for('static', filename='uploads/'+path)}}"
                               target="_blank">
                                <img src="{{url_for('static', filename='uploads/'+path)}}"
                                     class="image"
                                     height="250px">
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!--Features-->
            <div class="columns my-0 ">
                <div class="column">
                    <label class="label">Features, Options, Implements, etc.</label>
                    <div class="field">
                        <textarea class="textarea"
                                  rows=3
                                  placeholder="feature1, feature2, feature3, etc. "
                                  name="features">
                                  {%- if rental.features -%}
                                     {{ rental.features}}
                                  {%- endif -%}
                        </textarea>
                        <p class="help ">
                            <i class="fas fa-info-circle mr-2 "></i>Enter features separated by a comma.
                        </p>
                    </div>
                </div>
            </div>

            <!--Description-->
            <div class="columns my-0">
                <div class="column">
                    <label class="label">Rental Description</label>
                    <div class="field">
                        <textarea class="textarea"
                                  rows=3
                                  placeholder="Description"
                                  name="description">
                                  {%- if rental.description -%}
                                    {{rental.description}}
                                  {%- endif -%}
                        </textarea>
                    </div>
                </div>
            </div>

            <!--Implements-->
            <label class="label">Compatible Implements</label>
            <div class="columns my-0">
                <div class="column">
                    <div class="is-flex is-flex-direction-row">
                        <input class="input is-flex-grow-1 implement_adder"
                               type="text"
                               placeholder="Enter Implement Name Here">
                        <button class="button is-white has-text-dark implement_adder_submit"
                                type="button">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <a class="is-link implement_clear">Clear List</a>
                </div>
                <div class="column">
                    <div class="select is-multiple is-fullwidth">
                        <select multiple
                                class="implement_target"
                                name="implements">
                            {% for implement in rental.implements %}
                            <option selected
                                    value="{{implement}}">{{implement}}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <div class="my-5"
                 style="border-top: 2px solid whitesmoke;"></div>

            <div class="columns my-0 ">
                <div class="column">
                    <a href="{{url_for('admin.delete', id=rental.rental_id)}}"
                       class="button is-warning px-6">
                        <i class="fas fa-exclamation-triangle mr-3"></i>
                        Permanently Delete
                    </a>
                    <p class="help has-text-weight-bold">This cannot be reversed.</p>
                </div>
                <div class="column">
                    <div class="control is-flex is-fullwidth is-justify-content-flex-end ">
                        <button type="submit"
                                class="button is-info px-6">
                            <i class="fas fa-share-square mr-5"></i>Update Rental
                        </button>
                    </div>
                </div>
            </div>

        </form>

    </div>
</div>

{% endblock %}
